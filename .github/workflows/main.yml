    name: Access Google Drive
    on:
      push:
        branches: master

    jobs:
      drive-access:
        runs-on: ubuntu-latest
        steps:
          - name: Authenticate to Google Cloud
            uses: google-github-actions/auth@v2
            with:
              credentials_json: ${{ secrets.GOOGLE_APPLICATION_CREDENTIALS }}

          - name: Set up R
            uses: r-lib/actions/setup-r@v2
              
          - name: Install packages
            uses: r-lib/actions/setup-r-dependencies@v2
            with:
              cache: always
              packages: |
                any::jsonlite
                any::flextable
                any::tibble
                any::officer
                any::googledrive
                any::tidyverse
                any::gargle
                
          - name: Check out repository
            uses: actions/checkout@v4
            with:
              path: master
          - name: Dump GitHub context
            env:
              GITHUB_CONTEXT: ${{ toJson(github) }}
            run: echo "$GITHUB_CONTEXT"
          - name: Dump job context
            env:
              JOB_CONTEXT: ${{ toJson(job) }}
            run: echo "$JOB_CONTEXT"
          - name: Dump steps context
            env:
              STEPS_CONTEXT: ${{ toJson(steps) }}
            run: echo "$STEPS_CONTEXT"

          - name: Import data
            run: Rscript -e 'source("get_status.R")'

          - name: Commit results
            run: |
              git config --local user.email "actions@github.com"
              git config --local user.name "GitHub Actions"
              git add *.json
              git commit -m 'Data updated' || echo "No changes to commit"
              git push origin || echo "No changes to commit"

